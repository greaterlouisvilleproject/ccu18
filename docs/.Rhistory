social_associations = measure_140_value,
violent_crime = measure_43_value,
injury_deaths = measure_135_value,
air_pollution = measure_125_value,
drinking_water = measure_124_value,
severe_housing_problems = measure_136_value,
driving_alone_to_work = measure_67_value,
long_commute = measure_137_value) %>%
mutate(
year = 2016,
FIPS = as.numeric(FIPS)) %>%
mutate_at(
vars(poor_or_fair_health, low_birthweight, adult_smoking, adult_obesity, physical_inactivity,
access_to_exercise_opportunities, excessive_drinking, alcohol_impaired_driving_deaths, uninsured,
diabetes_monitoring, mammography_screening, severe_housing_problems, driving_alone_to_work,
long_commute),
funs(. * 100))
chr %<>%
weight_stl(names(chr)[names(chr) %!in% c("FIPS", "year")])
norm_z <- function(x){
z <- (x - mean(x, na.rm = TRUE))/sd(x, na.rm = TRUE)
}
health_z <- health_z %>%
group_by(year) %>%
mutate(ypll_index = norm_z(ypll),
pct_underweight_index = norm_z(pct_underweight),
poor_or_fair_index = norm_z(poor_or_fair),
physdays_index = norm_z(physdays),
mentdays_index = norm_z(mentdays))
chr <- read_csv("data/health/chr_measures_CSV_2018.csv")
chr %<>%
mutate(FIPS = paste0(`FIPS State Code`, `FIPS County Code`)) %>%
pull_peers_FIPS() %>%
select(
FIPS,
premature_death = measure_1_value,
poor_or_fair_health = measure_2_value,
poor_physical_health_days = measure_36_value,
poor_mental_health_days = measure_42_value,
low_birthweight = measure_37_value,
adult_smoking = measure_9_value,
adult_obesity = measure_11_value,
food_environment_index = measure_133_value,
physical_inactivity = measure_70_value,
access_to_exercise_opportunities = measure_132_value,
excessive_drinking = measure_49_value,
alcohol_impaired_driving_deaths = measure_134_value,
sexually_transmitted_infections = measure_45_value,
teen_births = measure_14_value,
uninsured = measure_85_value,
primary_care_physicians = measure_4_value,
dentists = measure_88_value,
mental_health_providers = measure_62_value,
preventable_hospital_stays = measure_5_value,
diabetes_monitoring = measure_7_value,
mammography_screening = measure_50_value,
high_school_graduation = measure_21_value,
some_college = measure_69_value,
unemployment = measure_23_value,
children_in_poverty = measure_24_value,
income_inequality = measure_44_value,
children_in_single_parent_households = measure_82_value,
social_associations = measure_140_value,
violent_crime = measure_43_value,
injury_deaths = measure_135_value,
air_pollution = measure_125_value,
drinking_water = measure_124_value,
severe_housing_problems = measure_136_value,
driving_alone_to_work = measure_67_value,
long_commute = measure_137_value) %>%
mutate(
year = 2016,
FIPS = as.numeric(FIPS)) %>%
mutate_at(
vars(poor_or_fair_health, low_birthweight, adult_smoking, adult_obesity, physical_inactivity,
access_to_exercise_opportunities, excessive_drinking, alcohol_impaired_driving_deaths, uninsured,
diabetes_monitoring, mammography_screening, severe_housing_problems, driving_alone_to_work,
long_commute),
funs(. * 100))
chr %<>%
weight_stl(names(chr)[names(chr) %!in% c("FIPS", "year")])
norm_z <- function(x){
z <- (x - mean(x, na.rm = TRUE))/sd(x, na.rm = TRUE)
}
chr_z <- chr
chr_z %<>%
mutate_at(
vars(names(chr_z)[names(chr_z) %!in% c("FIPS", "year")]),
norm_z)
chr_z %<>%
mutate(
outcomes =
premature_death*.5+
poor_or_fair_health*.1+
poor_physical_health_days*.1+
poor_mental_health_days*.1+
low_birthweight*.1,
health_behaviors =
adult_smoking*.1+
adult_obesity*.05+
food_environment_index*-.02+
physical_inactivity*.02+
access_to_exercise_opportunities*-.01+
excessive_drinking*.025+
alcohol_impaired_driving_deaths*.025+
sexually_transmitted_infections*.025+
teen_births*.025,
clinical_care =
uninsured*.05+
primary_care_physicians*.03+
dentists*.01+
mental_health_providers*.01+
preventable_hospital_stays*.05+
diabetes_monitoring*-.025+
mammography_screening*.025,
social_and_economic =
high_school_graduation*-.05+
some_college*-.05+
unemployment*.10+
children_in_poverty*.075+
income_inequality*.025+
children_in_single_parent_households*.025+
social_associations*-.025+
violent_crime*.025+
injury_deaths*.025,
physical_environment =
air_pollution*.025 +
severe_housing_problems*.02 +
driving_alone_to_work * .02 +
long_commute * .01,
factors = health_behaviors+clinical_care+social_and_economic+physical_environment
)
View(chr_z)
plot(chr_z$factors, chr_z$outcomes)
View(chr)
chr <- read_csv("data/health/chr_measures_CSV_2018.csv")
chr %<>%
mutate(FIPS = paste0(`FIPS State Code`, `FIPS County Code`)) %>%
pull_peers_FIPS() %>%
select(
FIPS,
premature_death = measure_1_value,
poor_or_fair_health = measure_2_value,
poor_physical_health_days = measure_36_value,
poor_mental_health_days = measure_42_value,
low_birthweight = measure_37_value,
adult_smoking = measure_9_value,
adult_obesity = measure_11_value,
food_environment_index = measure_133_value,
physical_inactivity = measure_70_value,
access_to_exercise_opportunities = measure_132_value,
excessive_drinking = measure_49_value,
alcohol_impaired_driving_deaths = measure_134_value,
sexually_transmitted_infections = measure_45_value,
teen_births = measure_14_value,
uninsured = measure_85_value,
primary_care_physicians = measure_4_value,
dentists = measure_88_value,
mental_health_providers = measure_62_value,
preventable_hospital_stays = measure_5_value,
diabetes_monitoring = measure_7_value,
mammography_screening = measure_50_value,
high_school_graduation = measure_21_value,
some_college = measure_69_value,
unemployment = measure_23_value,
children_in_poverty = measure_24_value,
income_inequality = measure_44_value,
children_in_single_parent_households = measure_82_value,
social_associations = measure_140_value,
violent_crime = measure_43_value,
injury_deaths = measure_135_value,
air_pollution = measure_125_value,
drinking_water = measure_124_value,
severe_housing_problems = measure_136_value,
driving_alone_to_work = measure_67_value,
long_commute = measure_137_value) %>%
mutate(
year = 2016,
FIPS = as.numeric(FIPS)) %>%
mutate_at(
vars(poor_or_fair_health, low_birthweight, adult_smoking, adult_obesity, physical_inactivity,
access_to_exercise_opportunities, excessive_drinking, alcohol_impaired_driving_deaths, uninsured,
diabetes_monitoring, mammography_screening, severe_housing_problems, driving_alone_to_work,
long_commute),
funs(. * 100))
chr %<>%
weight_stl(names(chr)[names(chr) %!in% c("FIPS", "year")])
norm_z <- function(x){
z <- (x - mean(x, na.rm = TRUE))/sd(x, na.rm = TRUE)
}
chr_z <- chr
chr_z %<>%
mutate_at(
vars(names(chr_z)[names(chr_z) %!in% c("FIPS", "year")]),
norm_z)
chr_z %<>%
mutate(
outcomes =
premature_death * -0.5 +
poor_or_fair_health * -0.1 +
poor_physical_health_days * -0.1 +
poor_mental_health_days * -0.1 +
low_birthweight * -0.1,
health_behaviors =
adult_smoking * -0.1 +
adult_obesity * -0.05 +
food_environment_index * 0.02 +
physical_inactivity * 0.02 +
access_to_exercise_opportunities * 0.01 +
excessive_drinking * -0.025 +
alcohol_impaired_driving_deaths * -0.025 +
sexually_transmitted_infections * -0.025 +
teen_births * -0.025,
clinical_care =
uninsured * -0.05 +
primary_care_physicians * 0.03 +
dentists * 0.01 +
mental_health_providers * 0.01 +
preventable_hospital_stays * -0.05 +
diabetes_monitoring * 0.025 +
mammography_screening * 0.025,
social_and_economic =
high_school_graduation * 0.05 +
some_college * 0.05 +
unemployment * -0.10 +
children_in_poverty * -0.075 +
income_inequality * -0.025 +
children_in_single_parent_households * -0.025 +
social_associations * 0.025 +
violent_crime * -0.025 +
injury_deaths * -0.025,
physical_environment =
air_pollution * -0.05 +
severe_housing_problems * -0.02 +
driving_alone_to_work * -0.02 +
long_commute * -0.01,
factors = health_behaviors + clinical_care + social_and_economic + physical_environment
)
plot(chr_z$factors, chr_z$outcomes)
plot(chr_z$health_behaviors, chr_z$outcomes)
plot(chr_z$clinical_care, chr_z$outcomes)
ggplot(chr_z, x = health_behaviors, y = outcomes)
ggplot(chr_z, x = health_behaviors, y = outcomes) +
geom_point()
ggplot(chr_z, aes(x = health_behaviors, y = outcomes)) +
geom_point()
ggplot(chr_z, aes(x = health_behaviors, y = outcomes)) +
geom_point() +
geom_smooth()
ggplot(chr_z, aes(x = health_behaviors, y = outcomes)) +
geom_point() +
geom_smooth(method = lm)
ggplot(chr_z, aes(x = health_behaviors, y = outcomes)) +
geom_point() +
geom_smooth(method = ols)
ggplot(chr_z, aes(x = health_behaviors, y = outcomes)) +
geom_point() +
geom_smooth(method = lm)
ggplot(chr_z, aes(x = clinical_care, y = outcomes)) +
geom_point() +
geom_smooth(method = lm)
ggplot(chr_z, aes(x = social_and_economic, y = outcomes)) +
geom_point() +
geom_smooth(method = lm)
ggplot(chr_z, aes(x = physical_environment, y = outcomes)) +
geom_point() +
geom_smooth(method = lm)
ggplot(chr_z, aes(x = clinical_care, y = outcomes)) +
geom_point() +
geom_smooth(method = lm)
chr_z <- chr
chr_z %<>%
mutate_at(
vars(names(chr_z)[names(chr_z) %!in% c("FIPS", "year")]),
norm_z) %>%
rename_at(
vars(names(chr_z)[names(chr_z) %!in% c("FIPS", "year")]),
paste0(., "_z"))
chr_z %<>%
mutate_at(
vars(names(chr_z)[names(chr_z) %!in% c("FIPS", "year")]),
norm_z) %>%
rename_at(
vars(names(chr_z)[names(chr_z) %!in% c("FIPS", "year")]),
funs(paste0(., "_z")))
chr <- read_csv("data/health/chr_measures_CSV_2018.csv")
chr %<>%
mutate(FIPS = paste0(`FIPS State Code`, `FIPS County Code`)) %>%
pull_peers_FIPS() %>%
select(
FIPS,
premature_death = measure_1_value,
poor_or_fair_health = measure_2_value,
poor_physical_health_days = measure_36_value,
poor_mental_health_days = measure_42_value,
low_birthweight = measure_37_value,
adult_smoking = measure_9_value,
adult_obesity = measure_11_value,
food_environment_index = measure_133_value,
physical_inactivity = measure_70_value,
access_to_exercise_opportunities = measure_132_value,
excessive_drinking = measure_49_value,
alcohol_impaired_driving_deaths = measure_134_value,
sexually_transmitted_infections = measure_45_value,
teen_births = measure_14_value,
uninsured = measure_85_value,
primary_care_physicians = measure_4_value,
dentists = measure_88_value,
mental_health_providers = measure_62_value,
preventable_hospital_stays = measure_5_value,
diabetes_monitoring = measure_7_value,
mammography_screening = measure_50_value,
high_school_graduation = measure_21_value,
some_college = measure_69_value,
unemployment = measure_23_value,
children_in_poverty = measure_24_value,
income_inequality = measure_44_value,
children_in_single_parent_households = measure_82_value,
social_associations = measure_140_value,
violent_crime = measure_43_value,
injury_deaths = measure_135_value,
air_pollution = measure_125_value,
drinking_water = measure_124_value,
severe_housing_problems = measure_136_value,
driving_alone_to_work = measure_67_value,
long_commute = measure_137_value) %>%
mutate(
year = 2016,
FIPS = as.numeric(FIPS)) %>%
mutate_at(
vars(poor_or_fair_health, low_birthweight, adult_smoking, adult_obesity, physical_inactivity,
access_to_exercise_opportunities, excessive_drinking, alcohol_impaired_driving_deaths, uninsured,
diabetes_monitoring, mammography_screening, severe_housing_problems, driving_alone_to_work,
long_commute),
funs(. * 100))
chr %<>%
weight_stl(names(chr)[names(chr) %!in% c("FIPS", "year")])
norm_z <- function(x){
z <- (x - mean(x, na.rm = TRUE))/sd(x, na.rm = TRUE)
}
chr_z <- chr
chr_z %<>%
mutate_at(
vars(names(chr_z)[names(chr_z) %!in% c("FIPS", "year")]),
norm_z) %>%
rename_at(
vars(names(chr_z)[names(chr_z) %!in% c("FIPS", "year")]),
funs(paste0(., "_z")))
chr_z %<>%
mutate(
outcomes =
premature_death * -0.5 +
poor_or_fair_health * -0.1 +
poor_physical_health_days * -0.1 +
poor_mental_health_days * -0.1 +
low_birthweight * -0.1,
health_behaviors =
adult_smoking * -0.1 +
adult_obesity * -0.05 +
food_environment_index * 0.02 +
physical_inactivity * 0.02 +
access_to_exercise_opportunities * 0.01 +
excessive_drinking * -0.025 +
alcohol_impaired_driving_deaths * -0.025 +
sexually_transmitted_infections * -0.025 +
teen_births * -0.025,
clinical_care =
uninsured * -0.05 +
primary_care_physicians * 0.03 +
dentists * 0.01 +
mental_health_providers * 0.01 +
preventable_hospital_stays * -0.05 +
diabetes_monitoring * 0.025 +
mammography_screening * 0.025,
social_and_economic =
high_school_graduation * 0.05 +
some_college * 0.05 +
unemployment * -0.10 +
children_in_poverty * -0.075 +
income_inequality * -0.025 +
children_in_single_parent_households * -0.025 +
social_associations * 0.025 +
violent_crime * -0.025 +
injury_deaths * -0.025,
physical_environment =
air_pollution * -0.05 +
severe_housing_problems * -0.02 +
driving_alone_to_work * -0.02 +
long_commute * -0.01,
factors = health_behaviors + clinical_care + social_and_economic + physical_environment)
chr <- read_csv("data/health/chr_measures_CSV_2018.csv")
chr %<>%
mutate(FIPS = paste0(`FIPS State Code`, `FIPS County Code`)) %>%
pull_peers_FIPS() %>%
select(
FIPS,
premature_death = measure_1_value,
poor_or_fair_health = measure_2_value,
poor_physical_health_days = measure_36_value,
poor_mental_health_days = measure_42_value,
low_birthweight = measure_37_value,
adult_smoking = measure_9_value,
adult_obesity = measure_11_value,
food_environment_index = measure_133_value,
physical_inactivity = measure_70_value,
access_to_exercise_opportunities = measure_132_value,
excessive_drinking = measure_49_value,
alcohol_impaired_driving_deaths = measure_134_value,
sexually_transmitted_infections = measure_45_value,
teen_births = measure_14_value,
uninsured = measure_85_value,
primary_care_physicians = measure_4_value,
dentists = measure_88_value,
mental_health_providers = measure_62_value,
preventable_hospital_stays = measure_5_value,
diabetes_monitoring = measure_7_value,
mammography_screening = measure_50_value,
high_school_graduation = measure_21_value,
some_college = measure_69_value,
unemployment = measure_23_value,
children_in_poverty = measure_24_value,
income_inequality = measure_44_value,
children_in_single_parent_households = measure_82_value,
social_associations = measure_140_value,
violent_crime = measure_43_value,
injury_deaths = measure_135_value,
air_pollution = measure_125_value,
drinking_water = measure_124_value,
severe_housing_problems = measure_136_value,
driving_alone_to_work = measure_67_value,
long_commute = measure_137_value) %>%
mutate(
year = 2016,
FIPS = as.numeric(FIPS)) %>%
mutate_at(
vars(poor_or_fair_health, low_birthweight, adult_smoking, adult_obesity, physical_inactivity,
access_to_exercise_opportunities, excessive_drinking, alcohol_impaired_driving_deaths, uninsured,
diabetes_monitoring, mammography_screening, severe_housing_problems, driving_alone_to_work,
long_commute),
funs(. * 100))
chr %<>%
weight_stl(names(chr)[names(chr) %!in% c("FIPS", "year")])
norm_z <- function(x){
z <- (x - mean(x, na.rm = TRUE))/sd(x, na.rm = TRUE)
}
chr_z <- chr
chr_z %<>%
mutate_at(
vars(names(chr_z)[names(chr_z) %!in% c("FIPS", "year")]),
norm_z)
chr_z %<>%
mutate(
outcomes =
premature_death * -0.5 +
poor_or_fair_health * -0.1 +
poor_physical_health_days * -0.1 +
poor_mental_health_days * -0.1 +
low_birthweight * -0.1,
health_behaviors =
adult_smoking * -0.1 +
adult_obesity * -0.05 +
food_environment_index * 0.02 +
physical_inactivity * 0.02 +
access_to_exercise_opportunities * 0.01 +
excessive_drinking * -0.025 +
alcohol_impaired_driving_deaths * -0.025 +
sexually_transmitted_infections * -0.025 +
teen_births * -0.025,
clinical_care =
uninsured * -0.05 +
primary_care_physicians * 0.03 +
dentists * 0.01 +
mental_health_providers * 0.01 +
preventable_hospital_stays * -0.05 +
diabetes_monitoring * 0.025 +
mammography_screening * 0.025,
social_and_economic =
high_school_graduation * 0.05 +
some_college * 0.05 +
unemployment * -0.10 +
children_in_poverty * -0.075 +
income_inequality * -0.025 +
children_in_single_parent_households * -0.025 +
social_associations * 0.025 +
violent_crime * -0.025 +
injury_deaths * -0.025,
physical_environment =
air_pollution * -0.05 +
severe_housing_problems * -0.02 +
driving_alone_to_work * -0.02 +
long_commute * -0.01,
factors = health_behaviors + clinical_care + social_and_economic + physical_environment) %>%
rename_at(
vars(names(chr_z)[names(chr_z) %!in% c("FIPS", "year", "outcomes", "health_behaviors", "clinical_care", "social_and_economic", "physical_environment", "factors")]),
funs(paste0(., "_z")))
data <- chr_z
setwd('C:/Users/Harrison Kirby/Desktop/GLP/ccu18/docs')
rmarkdown::render_site()
setwd('C:/Users/Harrison Kirby/Desktop/GLP/ccu18/docs')
rmarkdown::render_site()
setwd('C:/Users/Harrison Kirby/Desktop/GLP/ccu18/docs')
rmarkdown::render_site()
setwd('C:/Users/Harrison Kirby/Desktop/GLP/ccu18/docs')
rmarkdown::render_site()
setwd('C:/Users/Harrison Kirby/Desktop/GLP/ccu18/docs')
rmarkdown::render_site()
setwd('C:/Users/Harrison Kirby/Desktop/GLP/ccu18/docs')
rmarkdown::render_site()
setwd('C:/Users/Harrison Kirby/Desktop/GLP/ccu18/docs')
rmarkdown::render_site()
setwd('C:/Users/Harrison Kirby/Desktop/GLP/ccu18/docs')
rmarkdown::render_site()
