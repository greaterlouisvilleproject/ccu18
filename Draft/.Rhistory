select(FIPS, year, bach_plus_per_white, total)
degree_white <- bind_rows(degree_white_05, degree_white_08) %>%
weight_stl('bach_plus_per_white', 'total')
#Black
degree_black_05 = acs_time("/data/education/B15002B/Y05/", starting_year = 2005)
degree_black_08 = acs_time("/data/education/B15002B/Y08/", starting_year = 2008)
degree_black_05 %<>%
mutate(
total = `Estimate; Total:`,
bach_plus_per_black =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Graduate degree` +
`Estimate; Male: - Graduate degree`)
/total * 100) %>%
select(FIPS, year, bach_plus_per_black, total)
degree_black_08 %<>%
mutate(
total = `Estimate; Total:`,
bach_plus_per_black =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Graduate degree` +
`Estimate; Male: - Graduate degree`)
/total * 100) %>%
select(FIPS, year, bach_plus_per_black, total)
degree_black = bind_rows(degree_black_05, degree_black_08) %>%
weight_stl('bach_plus_per_black', 'total')
#Hispanic
degree_hispanic_05 = acs_time("/data/education/B15002I/Y05/", starting_year = 2005)
degree_hispanic_08 = acs_time("/data/education/B15002I/Y08/", starting_year = 2008)
degree_hispanic_05 = degree_hispanic_05 %>%
mutate(
total = `Estimate; Total:`,
bach_plus_per_hispanic =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Graduate degree` +
`Estimate; Male: - Graduate degree`)
/total * 100) %>%
select(FIPS, year, bach_plus_per_hispanic, total)
degree_hispanic_08 = degree_hispanic_08 %>%
mutate(
total = `Estimate; Total:`,
bach_plus_per_hispanic =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Graduate degree` +
`Estimate; Male: - Graduate degree`)
/total * 100) %>%
select(FIPS, year, bach_plus_per_hispanic, total)
degree_hispanic = bind_rows(degree_hispanic_05, degree_hispanic_08) %>%
weight_stl('bach_plus_per_hispanic', 'total')
data %<>% bind_df(degree_white, degree_black, degree_hispanic)
rm(degree_white_05, degree_white_08, degree_white, degree_black_05, degree_black_08, degree_black, degree_hispanic_05, degree_hispanic_08, degree_hispanic)
source('C:/Users/Harrison Kirby/Desktop/GLP/glp_website/graphing_functions.R')
graph_trendline_race(data,
vars = c('bach_plus_per_white', 'bach_plus_per_black', 'bach_plus_per_hispanic'),
rollmean = 5)
source('C:/Users/Harrison Kirby/Desktop/GLP/glp_website/graphing_functions.R')
graph_trendline_race(data,
vars = c('bach_plus_per_white', 'bach_plus_per_black', 'bach_plus_per_hispanic'),
rollmean = 5)
warnings()
graph_trendline_race(data,
vars = c('bach_plus_per_white', 'bach_plus_per_black', 'bach_plus_per_hispanic'),
rollmean = 5)
source('C:/Users/Harrison Kirby/Desktop/GLP/glp_website/graphing_functions.R')
graph_trendline_race(data,
vars = c('bach_plus_per_white', 'bach_plus_per_black', 'bach_plus_per_hispanic'),
rollmean = 5)
ggplotly(rank_and_nb_group(data[data$year == 2016,],
'bach_plus_per',
plot_title = 'Bachelor Degrees, Ages 25-64, 2016'))
library(plotly)
ggplotly(rank_and_nb_group(data[data$year == 2016,],
'bach_plus_per',
plot_title = 'Bachelor Degrees, Ages 25-64, 2016'))
knitr::opts_knit$set(root.dir = "C:/Users/Harrison Kirby/Desktop/GLP/ccu18")
knitr::opts_chunk$set(message = FALSE, warning = FALSE, echo = FALSE)
options(knitr.duplicate.label = 'allow')
#Data
library(survey)
library(tidyverse)
library(magrittr)
#Graphing
library(ggthemes)
library(classInt)
library(showtext)
library(reshape2)
library(plotly)
#Mapping
library(rgdal)
library(RColorBrewer)
library(leaflet)
#library(feather)
acs_time <- function(folder, starting_year = 2005){
wd <- getwd()
directory <- paste0(wd, folder)
file_names <- list.files(directory)
n <- length(file_names)
y <- starting_year
for (i in 1:n){
file_path <- paste0(wd, folder, file_names[i])
data <- read_csv(file_path, skip=1, col_types = cols("Id2" = col_double()))
names(data)[names(data) == 'Id2'] <- 'FIPS'
all_peers <- data %>% filter(FIPS %in% c(1073, 12031, 18097, 21111, 26081,
29095, 29189, 29510, 31055, 37081,
37119, 37183, 39049, 39061, 39113,
40109, 40143, 45045, 47037, 47093,
47157, 51760))
all_peers$year <- y
y <- y + 1
if(i == 1){
df <- all_peers
}
else{
names(all_peers) <- names(df)
df <- rbind(df, all_peers)
}
}
df
}
pull_peers_MSA<-function(data){
all.peers <- filter(data, data$MSA %in% c("24340", "41180", "36420", "46140", "24860", "28940", "13820", "26900", "31140", "28140", "36540", "24660", "16740", "18140", "17140", "34980", "32820", "27260", "39580", "19380", "40060"))
all.peers$baseline <- 1
all.peers$current  <- 1
all.peers$baseline[all.peers$MSA == 24340 | all.peers$MSA == 41180
|all.peers$MSA == 36420 | all.peers$MSA == 46140
|all.peers$MSA == 24860 | all.peers$MSA == 28940] <-0
all.peers$current[all.peers$MSA == 27260 | all.peers$MSA == 39580
|all.peers$MSA == 19380 | all.peers$MSA == 40060] <-0
all.peers
}
pull_peers_FIPS <- function(dat){
all.peers <- subset(dat, dat$FIPS == 1073 | dat$FIPS == 37119
|dat$FIPS == 39061 |dat$FIPS == 39049
|dat$FIPS == 26081 |dat$FIPS == 37081
|dat$FIPS == 45045 |dat$FIPS == 18097
|dat$FIPS == 29095 |dat$FIPS == 47093
|dat$FIPS == 21111 |dat$FIPS == 47157
|dat$FIPS == 47037 |dat$FIPS == 40109
|dat$FIPS == 31055 |dat$FIPS == 29189
|dat$FIPS == 29510 |dat$FIPS == 40143
|dat$FIPS == 12031 |dat$FIPS == 37183
|dat$FIPS == 39113 |dat$FIPS == 51760
|dat$FIPS == "01073" | dat$FIPS == "MERGED")
all.peers$baseline <- 1
all.peers$current <- 1
all.peers$baseline[all.peers$FIPS==26081|all.peers$FIPS==29189
|all.peers$FIPS==29510|all.peers$FIPS==40109
|all.peers$FIPS==40143|all.peers$FIPS==45045
|all.peers$FIPS==47093|all.peers$FIPS=="MERGED"]<-0
all.peers$current[all.peers$FIPS== 12031|all.peers$FIPS==37183|
all.peers$FIPS==39113|all.peers$FIPS==51760]<-0
city <- c('Grand Rapids', 'St. Louis', 'Oklahoma City', 'Tulsa', 'Greenville', 'Knoxville',
'Birmingham', 'Indianapolis', 'Louisville', 'Kansas City', 'Omaha', 'Greensboro',
'Charlotte', 'Columbus', 'Cincinnati', 'Nashville', 'Memphis', 'Jacksonville',
'Raleigh', 'Dayton', 'Richmond')
FIPS_codes <- c(26081, 'MERGED', 40109, 40143, 45045, 47093, 1073, 18097, 21111, 29095, 31055,
37081, 37119, 39049, 39061, 47037, 47157, 12031, 37183, 39113, 51760)
names_df <- data.frame(city, FIPS_codes)
all.peers <- left_join(all.peers, names_df, by = c('FIPS' = 'FIPS_codes'))
all.peers
}
weight_stl <- function(df, variable, weight_variable){
df$var <- df[[variable]]
df$weight_var <- df[[weight_variable]]
df %<>%
mutate(FIPS = replace(FIPS, FIPS == '29189' | FIPS == '29510', 'MERGED')) %>%
group_by(FIPS, year) %>%
summarise(var = weighted.mean(var, weight_var)) %>%
ungroup()
df[[variable]] <- df$var
df %<>% select(-var)
df
}
bind_df <- function(...){
data_frames <- list(...)
output <- reduce(data_frames, full_join, by = c('FIPS', 'year'))
output
}
source('C:/Users/Harrison Kirby/Desktop/GLP/glp_website/graphing_functions.R')
map_jc = readOGR('data/Lou Maps', layer = "JC Tracts",
GDAL1_integer64_policy = TRUE, stringsAsFactors = FALSE, verbose = FALSE)
map_jc$TRACT <- as.numeric(map_jc$TRACT)
nh_names <- read_csv('data/Lou Maps/tract_to_nh.csv')
nh_names$Id2 <- substr(nh_names$Id2, 6, 13)
nh_names$Id2 <- as.numeric(nh_names$Id2)
map_jc@data <- full_join(map_jc@data, nh_names, by = c('TRACT' = 'Id2'))
map_jc@data$l_line1 <- paste("Tract #:", map_jc@data$TRACT, "in the")
map_jc@data$l_line2 <- paste(map_jc@data$Neighborhood, "neighborhood")
web = TRUE
degree_df <- acs_time("/data/education/B15002/")
degree_df %<>%
mutate(
total = `Estimate; Total:`,
bach_plus_per =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Doctorate degree` +
`Estimate; Male: - Doctorate degree` +
`Estimate; Female: - Master's degree` +
`Estimate; Male: - Master's degree`)
/ total * 100) %>%
weight_stl('bach_plus_per', 'total')
knitr::opts_knit$set(root.dir = "C:/Users/Harrison Kirby/Desktop/GLP/ccu18")
knitr::opts_chunk$set(message = FALSE, warning = FALSE, echo = FALSE)
options(knitr.duplicate.label = 'allow')
#Data
library(survey)
library(tidyverse)
library(magrittr)
#Graphing
library(ggthemes)
library(classInt)
library(showtext)
library(reshape2)
library(plotly)
#Mapping
library(rgdal)
library(RColorBrewer)
library(leaflet)
#library(feather)
acs_time <- function(folder, starting_year = 2005){
wd <- getwd()
directory <- paste0(wd, folder)
file_names <- list.files(directory)
n <- length(file_names)
y <- starting_year
for (i in 1:n){
file_path <- paste0(wd, folder, file_names[i])
data <- read_csv(file_path, skip=1, col_types = cols("Id2" = col_double()))
names(data)[names(data) == 'Id2'] <- 'FIPS'
all_peers <- data %>% filter(FIPS %in% c(1073, 12031, 18097, 21111, 26081,
29095, 29189, 29510, 31055, 37081,
37119, 37183, 39049, 39061, 39113,
40109, 40143, 45045, 47037, 47093,
47157, 51760))
all_peers$year <- y
y <- y + 1
if(i == 1){
df <- all_peers
}
else{
names(all_peers) <- names(df)
df <- rbind(df, all_peers)
}
}
df
}
pull_peers_MSA<-function(data){
all.peers <- filter(data, data$MSA %in% c("24340", "41180", "36420", "46140", "24860", "28940", "13820", "26900", "31140", "28140", "36540", "24660", "16740", "18140", "17140", "34980", "32820", "27260", "39580", "19380", "40060"))
all.peers$baseline <- 1
all.peers$current  <- 1
all.peers$baseline[all.peers$MSA == 24340 | all.peers$MSA == 41180
|all.peers$MSA == 36420 | all.peers$MSA == 46140
|all.peers$MSA == 24860 | all.peers$MSA == 28940] <-0
all.peers$current[all.peers$MSA == 27260 | all.peers$MSA == 39580
|all.peers$MSA == 19380 | all.peers$MSA == 40060] <-0
all.peers
}
pull_peers_FIPS <- function(dat){
all.peers <- subset(dat, dat$FIPS == 1073 | dat$FIPS == 37119
|dat$FIPS == 39061 |dat$FIPS == 39049
|dat$FIPS == 26081 |dat$FIPS == 37081
|dat$FIPS == 45045 |dat$FIPS == 18097
|dat$FIPS == 29095 |dat$FIPS == 47093
|dat$FIPS == 21111 |dat$FIPS == 47157
|dat$FIPS == 47037 |dat$FIPS == 40109
|dat$FIPS == 31055 |dat$FIPS == 29189
|dat$FIPS == 29510 |dat$FIPS == 40143
|dat$FIPS == 12031 |dat$FIPS == 37183
|dat$FIPS == 39113 |dat$FIPS == 51760
|dat$FIPS == "01073" | dat$FIPS == "MERGED")
all.peers$baseline <- 1
all.peers$current <- 1
all.peers$baseline[all.peers$FIPS==26081|all.peers$FIPS==29189
|all.peers$FIPS==29510|all.peers$FIPS==40109
|all.peers$FIPS==40143|all.peers$FIPS==45045
|all.peers$FIPS==47093|all.peers$FIPS=="MERGED"]<-0
all.peers$current[all.peers$FIPS== 12031|all.peers$FIPS==37183|
all.peers$FIPS==39113|all.peers$FIPS==51760]<-0
city <- c('Grand Rapids', 'St. Louis', 'Oklahoma City', 'Tulsa', 'Greenville', 'Knoxville',
'Birmingham', 'Indianapolis', 'Louisville', 'Kansas City', 'Omaha', 'Greensboro',
'Charlotte', 'Columbus', 'Cincinnati', 'Nashville', 'Memphis', 'Jacksonville',
'Raleigh', 'Dayton', 'Richmond')
FIPS_codes <- c(26081, 'MERGED', 40109, 40143, 45045, 47093, 1073, 18097, 21111, 29095, 31055,
37081, 37119, 39049, 39061, 47037, 47157, 12031, 37183, 39113, 51760)
names_df <- data.frame(city, FIPS_codes)
all.peers <- left_join(all.peers, names_df, by = c('FIPS' = 'FIPS_codes'))
all.peers
}
weight_stl <- function(df, variable, weight_variable){
df$var <- df[[variable]]
df$weight_var <- df[[weight_variable]]
df %<>%
mutate(FIPS = replace(FIPS, FIPS == '29189' | FIPS == '29510', 'MERGED')) %>%
group_by(FIPS, year) %>%
summarise(var = weighted.mean(var, weight_var)) %>%
ungroup()
df[[variable]] <- df$var
df %<>% select(-var)
df
}
bind_df <- function(...){
data_frames <- list(...)
output <- reduce(data_frames, full_join, by = c('FIPS', 'year'))
output
}
source('C:/Users/Harrison Kirby/Desktop/GLP/glp_website/graphing_functions.R')
map_jc = readOGR('data/Lou Maps', layer = "JC Tracts",
GDAL1_integer64_policy = TRUE, stringsAsFactors = FALSE, verbose = FALSE)
map_jc$TRACT <- as.numeric(map_jc$TRACT)
nh_names <- read_csv('data/Lou Maps/tract_to_nh.csv')
nh_names$Id2 <- substr(nh_names$Id2, 6, 13)
nh_names$Id2 <- as.numeric(nh_names$Id2)
map_jc@data <- full_join(map_jc@data, nh_names, by = c('TRACT' = 'Id2'))
map_jc@data$l_line1 <- paste("Tract #:", map_jc@data$TRACT, "in the")
map_jc@data$l_line2 <- paste(map_jc@data$Neighborhood, "neighborhood")
web = TRUE
degree_df <- acs_time("/data/education/B15002/")
degree_df %<>%
mutate(
total = `Estimate; Total:`,
bach_plus_per =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Doctorate degree` +
`Estimate; Male: - Doctorate degree` +
`Estimate; Female: - Master's degree` +
`Estimate; Male: - Master's degree`)
/ total * 100) %>%
weight_stl('bach_plus_per', 'total')
data <- degree_df
data %<>% pull_peers_FIPS() %>% select(FIPS, city, year, current, baseline, bach_plus_per)
rm(degree_df)
rank_and_nb_group(data[data$year == 2016,],
'bach_plus_per',
plot_title = 'Bachelor Degrees, Ages 25-64, 2016')
#White
degree_white_05 <- acs_time("/data/education/B15002H/Y05/", starting_year = 2005)
degree_white_08 <- acs_time("/data/education/B15002H/Y08/", starting_year = 2008)
degree_white_05 <- degree_white_05 %>%
mutate(
total = `Estimate; Total:`,
bach_plus_per_white =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Graduate degree` +
`Estimate; Male: - Graduate degree`)
/ total * 100) %>%
select(FIPS, year, bach_plus_per_white, total)
degree_white_08 <- degree_white_08 %>%
mutate(
total = `Estimate; Total:`,
bach_plus_per_white =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Graduate degree` +
`Estimate; Male: - Graduate degree`)
/total * 100) %>%
select(FIPS, year, bach_plus_per_white, total)
degree_white <- bind_rows(degree_white_05, degree_white_08) %>%
weight_stl('bach_plus_per_white', 'total')
#Black
degree_black_05 = acs_time("/data/education/B15002B/Y05/", starting_year = 2005)
degree_black_08 = acs_time("/data/education/B15002B/Y08/", starting_year = 2008)
degree_black_05 %<>%
mutate(
total = `Estimate; Total:`,
bach_plus_per_black =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Graduate degree` +
`Estimate; Male: - Graduate degree`)
/total * 100) %>%
select(FIPS, year, bach_plus_per_black, total)
degree_black_08 %<>%
mutate(
total = `Estimate; Total:`,
bach_plus_per_black =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Graduate degree` +
`Estimate; Male: - Graduate degree`)
/total * 100) %>%
select(FIPS, year, bach_plus_per_black, total)
degree_black = bind_rows(degree_black_05, degree_black_08) %>%
weight_stl('bach_plus_per_black', 'total')
#Hispanic
degree_hispanic_05 = acs_time("/data/education/B15002I/Y05/", starting_year = 2005)
degree_hispanic_08 = acs_time("/data/education/B15002I/Y08/", starting_year = 2008)
degree_hispanic_05 = degree_hispanic_05 %>%
mutate(
total = `Estimate; Total:`,
bach_plus_per_hispanic =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Graduate degree` +
`Estimate; Male: - Graduate degree`)
/total * 100) %>%
select(FIPS, year, bach_plus_per_hispanic, total)
degree_hispanic_08 = degree_hispanic_08 %>%
mutate(
total = `Estimate; Total:`,
bach_plus_per_hispanic =
(`Estimate; Female: - Bachelor's degree` +
`Estimate; Male: - Bachelor's degree` +
`Estimate; Female: - Graduate degree` +
`Estimate; Male: - Graduate degree`)
/total * 100) %>%
select(FIPS, year, bach_plus_per_hispanic, total)
degree_hispanic = bind_rows(degree_hispanic_05, degree_hispanic_08) %>%
weight_stl('bach_plus_per_hispanic', 'total')
data %<>% bind_df(degree_white, degree_black, degree_hispanic)
rm(degree_white_05, degree_white_08, degree_white, degree_black_05, degree_black_08, degree_black, degree_hispanic_05, degree_hispanic_08, degree_hispanic)
source('C:/Users/Harrison Kirby/Desktop/GLP/glp_website/graphing_functions.R')
graph_trendline_race(data,
vars = c('bach_plus_per_white', 'bach_plus_per_black', 'bach_plus_per_hispanic'),
rollmean = 5)
degree_map <- read_csv('Data/Education/ACS_16_5YR_B15001_with_ann.csv', skip = 1)
degree_map %<>%
mutate(
num_25_34 =
`Estimate; Male: - 25 to 34 years:` +
`Estimate; Female: - 25 to 34 years:`,
num_25_64 =
`Estimate; Male: - 25 to 34 years:` +
`Estimate; Male: - 35 to 44 years:` +
`Estimate; Male: - 45 to 64 years:` +
`Estimate; Female: - 25 to 34 years:` +
`Estimate; Female: - 35 to 44 years:` +
`Estimate; Female: - 45 to 64 years:`,
num_25_34_grad =
`Estimate; Male: - 25 to 34 years: - Graduate or professional degree` +
`Estimate; Female: - 25 to 34 years: - Graduate or professional degree`,
num_25_64_grad =
`Estimate; Male: - 25 to 34 years: - Graduate or professional degree` +
`Estimate; Male: - 35 to 44 years: - Graduate or professional degree` +
`Estimate; Male: - 45 to 64 years: - Graduate or professional degree` +
`Estimate; Female: - 25 to 34 years: - Graduate or professional degree` +
`Estimate; Female: - 35 to 44 years: - Graduate or professional degree` +
`Estimate; Female: - 45 to 64 years: - Graduate or professional degree`,
num_25_34_bach_plus =
`Estimate; Male: - 25 to 34 years: - Bachelor's degree` +
`Estimate; Female: - 25 to 34 years: - Bachelor's degree` +
num_25_34_grad,
num_25_64_bach_plus =
`Estimate; Male: - 25 to 34 years: - Bachelor's degree` +
`Estimate; Male: - 35 to 44 years: - Bachelor's degree` +
`Estimate; Male: - 45 to 64 years: - Bachelor's degree` +
`Estimate; Female: - 25 to 34 years: - Bachelor's degree` +
`Estimate; Female: - 35 to 44 years: - Bachelor's degree` +
`Estimate; Female: - 45 to 64 years: - Bachelor's degree` +
num_25_64_grad,
num_25_34_assoc_plus =
`Estimate; Male: - 25 to 34 years: - Associate's degree` +
`Estimate; Female: - 25 to 34 years: - Associate's degree` +
num_25_34_bach_plus,
num_25_64_assoc_plus =
`Estimate; Male: - 25 to 34 years: - Associate's degree` +
`Estimate; Male: - 35 to 44 years: - Associate's degree` +
`Estimate; Male: - 45 to 64 years: - Associate's degree` +
`Estimate; Female: - 25 to 34 years: - Associate's degree` +
`Estimate; Female: - 35 to 44 years: - Associate's degree` +
`Estimate; Female: - 45 to 64 years: - Associate's degree` +
num_25_64_bach_plus) %>%
transmute(
Id = Id,
per_25_34_assoc_plus = num_25_34_assoc_plus / num_25_34 * 100,
per_25_64_assoc_plus = num_25_64_assoc_plus / num_25_64 * 100,
per_25_34_bach_plus = num_25_34_bach_plus / num_25_34 * 100,
per_25_64_bach_plus = num_25_64_bach_plus / num_25_64 * 100,
per_25_34_grad = num_25_34_grad / num_25_34 * 100,
per_25_64_grad = num_25_64_grad / num_25_64 * 100)
map_data <- degree_map
map_jc@data<-full_join(map_jc@data, degree_map, by = c('GEO_ID' = 'Id'))
make_map("per_25_64_bach_plus",
name = "Bachelor Degrees or Higher",
legend_title = "Bachelor<br/>Degrees")
degree_poverty <- acs_time('/data/education/C17003/', starting_year = 2005)
degree_poverty %<>%
mutate(
total_pov = `Estimate; Income in the past 12 months below poverty level:`,
total_nonpov = `Estimate; Income in the past 12 months at or above poverty level:`,
bach_plus_per_pov = `Estimate; Income in the past 12 months below poverty level: - Bachelor's degree or higher` / total_pov * 100,
bach_plus_per_nonpov = `Estimate; Income in the past 12 months at or above poverty level: - Bachelor's degree or higher` / total_nonpov * 100) %>%
{
x <- .
full_join(
x %>% weight_stl('bach_plus_per_pov', 'total_pov'),
x %>% weight_stl('bach_plus_per_nonpov', 'total_nonpov')
)
}
data %<>% bind_df(degree_poverty)
rm(degree_poverty)
degree_df <- acs_time("/data/education/B15002/")
names(degree_df)
test <- data[,-c(year, city)]
test <- data[,-c('year', 'city')]
test <- data[,c('year', 'city')]
test <- data[,-c('year', 'city')]
weight_stl <- function(df_original, variables, weight_variable){
n <- 1
for(v in 1:length(variable){
weight_stl <- function(df_original, variables, weight_variable){
n <- 1
for(v in 1:length(variables){
weight_stl <- function(df_original, variables, weight_variable){
n <- 1
for(v in 1:length(variables){
